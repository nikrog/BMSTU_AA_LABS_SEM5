\chapter{Конструкторская часть}
В данном разделе будут представлены схемы алгоритмов умножения матриц (стандартный, Винограда, оптимизированный Винограда) и вычисления трудоемкости данных алгоритмов.
 

\section{Стандартный алгоритм умножения матриц}

На рисунке \ref{img:standard.png} приведена схема стандартного алгоритма умножения матриц.
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\

\img{230mm}{standard.png}{Схема стандартного алгоритма умножения матриц}


\FloatBarrier
\section{Алгоритм Винограда умножения матриц}
На рисунке \ref{img:vinograd.png} приведена схема алгоритма Винограда умножения матриц.
Можно заметить, что для алгоритма Винограда умножения матриц худшим случаем являются матрицы с нечётной общей размерностью, а лучшим -- с чётной, так как последний цикл в этом случае не задействуется.
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\

\img{230mm}{vinograd.png}{Схема алгоритма Винограда умножения матриц}


\FloatBarrier
\section{Оптимизированный алгоритм Винограда умножения матриц}
Алгоритм Винограда можно оптимизировать несколькими способами.
\begin{enumerate}[label={\arabic*)}]
	\item Заменить все выражения вида x = x + k на x += k;
	\item Использовать побитовый сдвиг влево на 1 бит (<<) вместо умножения на 2;
	\item Четвертый (последний) цикл для нечётных элементов алгоритма Винограда объединить с третьим, нечетность общей размерности входных матриц проверить до третьего цикла и установить соответствующий флаг, если флаг содержит значение истина, то выполняем дополнительные операции в третьем цикле (предвычисляем некоторые слагаемые для алгоритма).
\end{enumerate}

На рисунке \ref{img:vinograd_opt.png} приведена схема оптимизированного алгоритма Винограда умножения матриц.
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\

\\

\img{230mm}{vinograd_opt.png}{Оптимизированный алгоритм Винограда умножения матриц}



\FloatBarrier
\section{Оценка трудоемкости алгоритмов умножения матриц}

Для последующего вычисления трудоемкости необходимо ввести следующую модель вычислений:
\begin{itemize}
	\item базовые операции с трудоемкостью 2: /, /=, *, *=, \%, \%=;
	\item базовые операции с трудоемкостью 1: +, ++, +=, -,  $--$, -=, ==, !=, <, >, <=, >=, <<, >>, [];
	\item трудоемкость цикла: Fцикла = Fиниц. + Fсравн. + M * (Fтела + Fинк. + Fсравн.), где Fиниц., Fсравн., Fтела, Fинк. -- трудоемкости инициализации,  проверки условия цикла, тела цикла и инкрементирования соответственно, а M -- количество итераций;
	\item трудоемкость условного оператроа: F$_{if}$ = Fсравн. + 
	\begin{equation}
		+
		\left[ 
		\begin{array}{c} 
			min(f1, f2) - $лучший случай$\\
			max(f1, f2) - $худший случай$\\
		\end{array}
		\right.,\\
	\end{equation}где Fсравн., f1, f2 -- трудоемкости проверки условия, первого блока и второго блока, соответственно.
	
\end{itemize}

Обозначим во всех последующих вычислениях размерности входных матриц (A - N x M, B - M x Q) как N, M, Q.

Во всех рассматриваемых алгоритмах умножения матриц не будем учитывать проверку размерностей входных матриц A и B на корректность для операции умножения и инициализацию матрицы C, в которую записывается результат, так как данные действия являются общими для всех алгоритмов и имеют незначительную для всего алгоритма трудоемкость.

\subsection{Стандартный алгоритм умножения матриц}

Трудоёмкость стандартного алгоритма умножения матриц состоит из:
\begin{itemize}
	\item внешнего цикла по $i \in [1..N]$, трудоёмкость которого: $f = 2 + N \cdot (2 + f_{тела})$;
	\item внутреннего цикла по $j \in [1..Q]$, трудоёмкость которого: $f = 2 + Q \cdot (2 + f_{тела})$;
	\item внутреннего цикла по $k \in [1..M]$, трудоёмкость которого: $f = 2 + 14M$;
\end{itemize}

Суммарная трудоёмкость стандартного алгоритма умножения матриц:
\begin{equation}
	\label{for:standard}
	f_{standard} = 2 + N \cdot (4 + Q \cdot (4 + 14M)) = 2 + 4N + 4NQ + 14NMQ \approx 14NMQ
\end{equation}

\subsection{Алгоритм Винограда умножения матриц}

Трудоёмкость алгоритма Винограда умножения матриц состоит из:
\begin{itemize}
	\item создания и инициализации массивов MulH и MulV, трудоёмкость которого:
	\begin{equation}
		\label{for:init}
		f_{init} = N + Q;
	\end{equation}
	
	\item заполнения массива MulH, трудоёмкость которого:
	\begin{equation}
		\label{for:MulH}
		f_{MulH} = 2 + N \cdot (3 + \frac{M}{2} \cdot 15);
	\end{equation}
	
	\item заполнения массива MulV, трудоёмкость которого:
	\begin{equation}
		\label{for:MulV}
		f_{MulV} = 2 + Q \cdot (3 + \frac{M}{2} \cdot 15);
	\end{equation}
	
	\item цикла заполнения для чётных размеров, трудоёмкость которого:
	\begin{equation}
		\label{for:cycle3}
		f_{for3} = 2 + N \cdot (4 + Q \cdot (12 + \frac{M}{2} \cdot 29));
	\end{equation}
	
	\item цикла, для дополнения результата умножения суммой последних нечётных строки и столбца, если общая размерность входных матриц нечётная, трудоемкость которого:
	\begin{equation}
		\label{for:cycle4}
		f_{for4} = 3 + \begin{cases}
			0, & \text{л.с.}\\
			4 + M \cdot (4 + 16N), & \text{х.с.}
		\end{cases}
	\end{equation}
\end{itemize}

Трудоемкость в худшем случае (нечётная общая размерность матриц):
\begin{equation}
	\label{for:bad}
	f =  f_{MulH} + f_{MulV} + f_{for3} + f_{for4} \approx 14.5 \cdot NMQ
\end{equation}

Трудоемкость в лучшем случае (чётная общая размерность матриц):
\begin{equation}
	\label{for:good}
f =  f_{MulH} + f_{MulV} + f_{for3} + f_{for4} \approx 14.5 \cdot NMQ
\end{equation}


\subsection{Оптимизированный алгоритм Винограда умножения матриц}

Трудоёмкость оптимизированного алгоритма Винограда умножения матриц состоит из:
\begin{itemize}
	\item создания и инициализации массивов MulH и MulV, трудоёмкость которого:
	\begin{equation}
		\label{for:impr_init}
		f_{init} = N + Q;
	\end{equation}
	
	\item заполнения массива MulH, трудоёмкость которого:
	\begin{equation}
		\label{for:impr_MulH}
		f_{MulH} = 2 + N \cdot (3 + \frac{M}{2} \cdot 12);
	\end{equation}
	
	\item заполнения массива MulV, трудоёмкость которого:
	\begin{equation}
		\label{for:impr_MulV}
		f_{MulV} = 2 + Q \cdot (3 + \frac{M}{2} \cdot 12);
	\end{equation}
	
	\item цикла заполнения для чётных размеров, трудоёмкость которого:
	\begin{equation}
		\label{for:impr_cycle}
		f_{for3} = 2 + N \cdot (4 + Q \cdot (12 + \frac{M}{2} \cdot 24));
	\end{equation}
	
	\item условие, для дополнения умножения суммой последних нечётных строки и столбца, если общая размерность входных матриц нечётная, трудоемкость которого:
	\begin{equation}
		\label{for:if}
		f_{if} = NQ +
		\begin{cases}
			0, & \text{л.с.}\\
			N \cdot (4 + 12Q), & \text{х.с.}
		\end{cases}
	\end{equation}
\end{itemize}

Трудоемкость в худшем случае (нечётная общая размерность матриц)::
\begin{equation}
	\label{for:bad_impr}
	f = f_{MulH} + f_{MulV} + f_{for3} + f_{if} \approx 12NMQ
\end{equation}

Трудоемкость в лучшем случае (чётная общая размерность матриц):
\begin{equation}
	\label{for:good_impr}
	f = f_{MulH} + f_{MulV} + f_{for3} + f_{if} \approx 12NMQ
\end{equation}

\section*{Вывод}

В данном разделе были разработаны схемы алгоритмов умножения матриц (стандартный, Винограда, оптимизированный Винограда). Для каждого из них были оценены трудоемкости в лучшем и худшем случаях.